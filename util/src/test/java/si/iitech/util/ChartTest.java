package si.iitech.util;

import java.awt.Color;
import java.awt.image.BufferedImage;
import java.io.ByteArrayInputStream;
import java.io.File;
import java.io.IOException;
import java.util.Arrays;
import java.util.Collections;
import java.awt.geom.Ellipse2D;

import javax.imageio.ImageIO;

import org.junit.jupiter.api.Test;

public class ChartTest {

    private void testAllCharts(ChartObject... chartObjects) throws IOException {
        byte[] chart = IITechChartUtils.chartWithDetails(504, 207, "ChartWithDetails", chartObjects);
        ByteArrayInputStream inStreambj = new ByteArrayInputStream(chart);
        BufferedImage newImage = ImageIO.read(inStreambj);
        String tmpdir = System.getProperty("java.io.tmpdir");
        File file = new File(tmpdir + "/ChartWithDetails.png");
        ImageIO.write(newImage, "png", file);

        chart = IITechChartUtils.chart(140, 60, chartObjects);
        inStreambj = new ByteArrayInputStream(chart);
        newImage = ImageIO.read(inStreambj);
        tmpdir = System.getProperty("java.io.tmpdir");
        file = new File(tmpdir + "/Chart.png");
        ImageIO.write(newImage, "png", file);

        chart = IITechChartUtils.chartWithAllDetails(1008, 414, "ChartWithDetails", chartObjects);
        inStreambj = new ByteArrayInputStream(chart);
        newImage = ImageIO.read(inStreambj);
        tmpdir = System.getProperty("java.io.tmpdir");
        file = new File(tmpdir + "/ChartWithAllDetails.png");
        ImageIO.write(newImage, "png", file);
    }

    @Test
    public void testNumbersBetween1and1Point1AllotOfEntries() throws IOException {
        testAllCharts(
                IITechChartUtils.createChartObject("a", Color.BLUE,
                        Arrays.asList(
                                1.001, 1.008, 1.007, 1.004, 1.004, 1.003, 1.0046, 1.00478, 1.0056, 1.0066, 1.0077,
                                1.0088, 1.0044, 1.00345, 1.0067, 1.00356, 1.0077,
                                1.0088, 1.0099, 1.01, 1.0050,
                                1.001, 1.008, 1.007, 1.004, 1.004, 1.003, 1.0046, 1.00478, 1.0056, 1.0066, 1.0077,
                                1.0088, 1.0044, 1.00345, 1.0067, 1.00356, 1.0077,
                                1.0088, 1.0099, 1.01, 1.0050,
                                1.001, 1.008, 1.007, 1.004, 1.004, 1.003, 1.0046, 1.00478, 1.0056, 1.0066, 1.0077,
                                1.0088, 1.0044, 1.00345, 1.0067, 1.00356, 1.0077,
                                1.0088, 1.0099, 1.01, 1.0050,
                                1.001, 1.008, 1.007, 1.004, 1.004, 1.003, 1.0046, 1.00478, 1.0056, 1.0066, 1.0077,
                                1.0088, 1.0044, 1.00345, 1.0067, 1.00356, 1.0077,
                                1.0088, 1.0099, 1.01, 1.0050,
                                1.001, 1.008, 1.007, 1.004, 1.004, 1.003, 1.0046, 1.00478, 1.0056, 1.0066, 1.0077,
                                1.0088, 1.0044, 1.00345, 1.0067, 1.00356, 1.0077,
                                1.0088, 1.0099, 1.01, 1.0050,
                                1.001, 1.008, 1.007, 1.004, 1.004, 1.003, 1.0046, 1.00478, 1.0056, 1.0066, 1.0077,
                                1.0088, 1.0044, 1.00345, 1.0067, 1.00356, 1.0077,
                                1.0088, 1.0099, 1.01, 1.0050,
                                1.001, 1.008, 1.007, 1.004, 1.004, 1.003, 1.0046, 1.00478, 1.0056, 1.0066, 1.0077,
                                1.0088, 1.0044, 1.00345, 1.0067, 1.00356, 1.0077,
                                1.0088, 1.0099, 1.01, 1.0050,
                                1.001, 1.008, 1.007, 1.004, 1.004, 1.003, 1.0046, 1.00478, 1.0056, 1.0066, 1.0077,
                                1.0088, 1.0044, 1.00345, 1.0067, 1.00356, 1.0077,
                                1.0088, 1.0099, 1.01, 1.0050,
                                1.001, 1.008, 1.007, 1.004, 1.004, 1.003, 1.0046, 1.00478, 1.0056, 1.0066, 1.0077,
                                1.0088, 1.0044, 1.00345, 1.0067, 1.00356, 1.0077,
                                1.0088, 1.0099, 1.01, 1.0050,
                                1.001, 1.008, 1.007, 1.004, 1.004, 1.003, 1.0046, 1.00478, 1.0056, 1.0066, 1.0077,
                                1.0088, 1.0044, 1.00345, 1.0067, 1.00356, 1.0077,
                                1.0088, 1.0099, 1.01, 1.0050,
                                1.001, 1.008, 1.007, 1.004, 1.004, 1.003, 1.0046, 1.00478, 1.0056, 1.0066, 1.0077,
                                1.0088, 1.0044, 1.00345, 1.0067, 1.00356, 1.0077,
                                1.0088, 1.0099, 1.01, 1.0050,
                                1.001, 1.008, 1.007, 1.004, 1.004, 1.003, 1.0046, 1.00478, 1.0056, 1.0066, 1.0077,
                                1.0088, 1.0044, 1.00345, 1.0067, 1.00356, 1.0077,
                                1.0088, 1.0099, 1.01, 1.0050,
                                1.001, 1.008, 1.007, 1.004, 1.004, 1.003, 1.0046, 1.00478, 1.0056, 1.0066, 1.0077,
                                1.0088, 1.0044, 1.00345, 1.0067, 1.00356, 1.0077,
                                1.0088, 1.0099, 1.01, 1.0050,
                                1.001, 1.008, 1.007, 1.004, 1.004, 1.003, 1.0046, 1.00478, 1.0056, 1.0066, 1.0077,
                                1.0088, 1.0044, 1.00345, 1.0067, 1.00356, 1.0077,
                                1.0088, 1.0099, 1.01, 1.0050,
                                1.001, 1.008, 1.007, 1.004, 1.004, 1.003, 1.0046, 1.00478, 1.0056, 1.0066, 1.0077,
                                1.0088, 1.0044, 1.00345, 1.0067, 1.00356, 1.0077,
                                1.0088, 1.0099, 1.01, 1.0050,
                                1.001, 1.008, 1.007, 1.004, 1.004, 1.003, 1.0046, 1.00478, 1.0056, 1.0066, 1.0077,
                                1.0088, 1.0044, 1.00345, 1.0067, 1.00356, 1.0077,
                                1.0088, 1.0099, 1.01, 1.0050)),
                IITechChartUtils.createChartObjectWithShape("b", Color.RED, new Ellipse2D.Double(-3, -3, 6, 6),
                        Arrays.asList(
                                1.001, 1.008, 1.007, 1.004, 1.004, 1.003, 1.0046, 1.00478, 1.0056, 1.0066, 1.0077,
                                1.0088, 1.0044, 1.00345, 1.0067, 1.00356, 1.0077,
                                1.0088, 1.0099, 1.01, 1.0050,
                                1.001, 1.008, 1.007, 1.004, 1.004, 1.003, 1.0046, 1.00478, 1.0056, 1.0066, 1.0077,
                                1.0088, 1.0044, 1.00345, 1.0067, 1.00356, 1.0077,
                                null, null, null, null,
                                1.001, 1.008, 1.007, 1.004, 1.004, 1.003, 1.0046, 1.00478, 1.0056, 1.0066, 1.0077,
                                1.0088, 1.0044, 1.00345, 1.0067, 1.00356, 1.0077,
                                1.0088, 1.0099, 1.01, 1.0050,
                                null, 1.008, 1.007, 1.004, 1.004, 1.003, 1.0046, 1.00478, 1.0056, 1.0066, 1.0077,
                                1.0088, 1.0044, 1.00345, 1.0067, 1.00356, 1.0077,
                                1.0088, 1.0099, 1.01, 1.0050,
                                1.001, 1.008, 1.007, 1.004, 1.004, 1.003, 1.0046, 1.00478, 1.0056, 1.0066, 1.0077,
                                1.0088, 1.0044, 1.00345, 1.0067, 1.00356, 1.0077,
                                1.0088, 1.0099, 1.01, 1.0050,
                                1.001, null, 1.007, 1.004, 1.004, 1.003, 1.0046, 1.00478, 1.0056, 1.0066, 1.0077,
                                1.0088, 1.0044, 1.00345, 1.0067, 1.00356, 1.0077,
                                1.0088, 1.0099, 1.01, 1.0050,
                                1.001, 1.008, 1.007, null, 1.004, 1.003, 1.0046, 1.00478, 1.0056, 1.0066, 1.0077,
                                1.0088, 1.0044, 1.00345, 1.0067, 1.00356, 1.0077,
                                1.0088, 1.0099, 1.01, 1.0050,
                                1.001, 1.008, 1.007, 1.004, 1.004, 1.003, 1.0046, 1.00478, 1.0056, 1.0066, 1.0077,
                                1.0088, 1.0044, 1.00345, 1.0067, 1.00356, 1.0077,
                                1.0088, 1.0099, 1.01, 1.0050,
                                1.001, 1.008, 1.007, 1.004, 1.004, 1.003, 1.0046, 1.00478, 1.0056, 1.0066, 1.0077,
                                1.0088, 1.0044, 1.00345, 1.0067, 1.00356, 1.0077,
                                1.0088, 1.0099, 1.01, 1.0050,
                                1.001, 1.008, 1.007, 1.004, 1.004, 1.003, 1.0046, 1.00478, 1.0056, 1.0066, 1.0077,
                                1.0088, 1.0044, 1.00345, 1.0067, 1.00356, 1.0077,
                                1.0088, 1.0099, 1.01, 1.0050,
                                1.001, 1.008, 1.007, 1.004, 1.004, 1.003, 1.0046, 1.00478, 1.0056, 1.0066, 1.0077,
                                1.0088, 1.0044, 1.00345, 1.0067, 1.00356, 1.0077,
                                1.0088, 1.0099, 1.01, 1.0050,
                                1.001, 1.008, 1.007, 1.004, 1.004, 1.003, 1.0046, 1.00478, 1.0056, 1.0066, 1.0077,
                                1.0088, 1.0044, 1.00345, 1.0067, 1.00356, 1.0077,
                                1.0088, 1.0099, 1.01, 1.0050,
                                1.001, 1.008, 1.007, 1.004, 1.004, 1.003, 1.0046, 1.00478, 1.0056, 1.0066, 1.0077,
                                1.0088, 1.0044, 1.00345, 1.0067, 1.00356, 1.0077,
                                1.0088, 1.0099, 1.01, null,
                                1.001, 1.008, 1.007, 1.004, null, 1.003, 1.0046, 1.00478, 1.0056, 1.0066, 1.0077,
                                1.0088, 1.0044, 1.00345, 1.0067, 1.00356, 1.0077,
                                1.0088, 1.0099, 1.01, 1.0050,
                                1.001, 1.008, 1.007, 1.004, 1.004, 1.003, 1.0046, 1.00478, 1.0056, 1.0066, 1.0077,
                                1.0088, 1.0044, 1.00345, 1.0067, 1.00356, 1.0077,
                                1.0088, 1.0099, 1.01, 1.0050,
                                1.001, 1.008, 1.007, 1.004, 1.004, 1.003, 1.0046, 1.00478, 1.0056, 1.0066, 1.0077,
                                1.0088, 1.0044, 1.00345, 1.0067, 1.00356, 1.0077,
                                1.0088, 1.0099, 1.01, 1.0050)));
    }

    @Test
    public void testNumbersBetween1and1Point1() throws IOException {
        testAllCharts(

                IITechChartUtils.createChartObjectWithShape("b", Color.RED, new Ellipse2D.Double(-50, -50, 60, 60),
                        Arrays.asList(
                                1.001, 1.008, 1.007, 1.004, 1.004, 1.003, 1.0046, 1.00478, 1.0056, 1.0066, 1.0077,
                                1.0088, 1.0044, 1.00345, 1.0067, 1.00356, 1.0077,
                                1.0088, 1.0099, 1.01, 1.0050)));
    }

    @Test
    public void testNumbersBetween0and0Point1() throws IOException {
        testAllCharts(
                IITechChartUtils.createChartObject("a", Color.BLUE,
                        Arrays.asList(
                                0.001, 0.008, 0.007, 0.004, 0.004, 0.003, 0.0046, 0.00478, 0.0056, 0.0066, 0.0077,
                                0.0088, 0.0044, 0.00345, 0.0067, 0.00356, 0.0077,
                                0.0088, 0.0099, 0.01, 0.0050)));
    }

    @Test
    public void testNumbersBetween0and0Point000001() throws IOException {
        testAllCharts(
                IITechChartUtils.createChartObject("a", Color.BLUE,
                        Arrays.asList(
                                0.00000001, 0.00000008, 0.00000007, 0.00000004, 0.00000004, 0.00000003, 0.000000046,
                                0.0000000478, 0.000000056, 0.000000066, 0.000000077, 0.000000088, 0.000000044,
                                0.0000000345, 0.000000067, 0.0000000356, 0.000000077,
                                0.000000088, 0.000000099, 0.00000007, 0.000000050)));
    }

    @Test
    public void testNumbersBetween0and0Point000000001() throws IOException {
        testAllCharts(
                IITechChartUtils.createChartObject("a", Color.BLUE,
                        Arrays.asList(
                            0.00000000000003
                            ,0.000000000033943
                            ,0.0000000000355031
                            ,0.0000000000410091
                            ,0.0000000000441867
                            ,0.0000000000448051
                            ,0.0000000000480815
                            ,0.0000000000512007
                            ,0.000000000051275
                            ,0.0000000000515133
                            ,0.0000000000517925
                            ,0.0000000000519114
                            ,0.0000000000528172
                            ,0.000000000052999
                            ,0.0000000000530348
                            ,0.0000000000536007
                            ,0.0000000000540209
                            ,0.0000000000547246
                            ,0.0000000000549211
                            ,0.000000000055064
                            ,0.0000000000571428
                            ,0.0000000000575649
                            ,0.0000000000577308
                            ,0.000000000058547
                            ,0.0000000000586629
                            ,0.0000000000590684
                            ,0.0000000000599822
                            ,0.0000000000613597
                            ,0.0000000000638004
                            ,0.0000000000638816
                            ,0.0000000000641692
                            ,0.0000000000644439
                            ,0.0000000000649572
                            ,0.0000000000649681
                            ,0.0000000000658056
                            ,0.0000000000659432
                            ,0.0000000000669766
                            ,0.0000000000669802
                            ,0.0000000000682307
                            ,0.0000000000712134
                            ,0.0000000000722996
                            ,0.0000000000736173
                            ,0.0000000000740737
                            ,0.0000000000740793
                            ,0.0000000000741485
                            ,0.0000000000750467
                            ,0.000000000075068
                            ,0.0000000000754446
                            ,0.0000000000758189
                            ,0.0000000000760592
                            ,0.0000000000768088
                            ,0.000000000076883
                            ,0.0000000000777152
                            ,0.0000000000780403
                            ,0.0000000000781642
                            ,0.0000000000794592
                            ,0.0000000000794845
                            ,0.0000000000801558
                            ,0.0000000000811609
                            ,0.0000000000818694
                            ,0.0000000000818749
                            ,0.0000000000830698
                            ,0.0000000000830825
                            ,0.0000000000832077
                            ,0.0000000000836444
                            ,0.0000000000837173
                            ,0.0000000000840502
                            ,0.0000000000843186
                            ,0.000000000084586
                            ,0.0000000000849786
                            ,0.0000000000851034
                            ,0.000000000085248
                            ,0.0000000000854287
                            ,0.0000000000854936
                            ,0.0000000000860403
                            ,0.0000000000860432
                            ,0.0000000000861364
                            ,0.0000000000868119
                            ,0.0000000000870099
                            ,0.0000000000874767
                            ,0.0000000000876959
                            ,0.0000000000881002
                            ,0.0000000000883714
                            ,0.0000000000884019
                            ,0.0000000000884242
                            ,0.0000000000885147
                            ,0.0000000000885511
                            ,0.0000000000891617
                            ,0.0000000000897356
                            ,0.0000000000900635
                            ,0.0000000000910532
                            ,0.0000000000912346
                            ,0.0000000000919598
                            ,0.0000000000921319
                            ,0.0000000000937313
                            ,0.0000000000937784
                            ,0.0000000000940546
                            ,0.0000000000941298
                            ,0.0000000000941371
                            ,0.000000000094291
                            ,0.0000000000943194
                            ,0.0000000000943538
                            ,0.0000000000944784
                            ,0.0000000000950117
                            ,0.0000000000951237
                            ,0.0000000000951578
                            ,0.0000000000956131
                            ,0.0000000000961122
                            ,0.0000000000962708
                            ,0.0000000000972106
                            ,0.0000000000982568
                            ,0.0000000000982568
                            ,0.0000000000985626

                        )));

    }

    @Test
    public void testNumbersBetween0and1() throws IOException {
        testAllCharts(
                IITechChartUtils.createChartObject("a", Color.BLUE,
                        Arrays.asList(
                                0.5, 0.54, 0.58, 0.64, 0.84, 0.74, 0.44, 0.24, 0.14, 0.52, 0.54, 0.54, 0.24, 0.54, 0.34,
                                0.54, 0.64,
                                0.74, 0.84, 0.14, 0.24)),
                IITechChartUtils.createChartObject("b", Color.BLUE,
                        Arrays.asList(
                                0.5, 0.354, 0.358, 0.364, 0.384, 0.394, 0.344, 0.324, 0.314, 0.352, 0.354, 0.354, 0.324,
                                0.354, 0.334,
                                0.354, 0.364, 0.374, 0.384, 0.314, 0.1)),
                IITechChartUtils.createChartObject("c", Color.BLUE,
                        Arrays.asList(
                                0.5, 0.654, 0.658, 0.664, 0.684, 0.694, 0.644, 0.624, 0.614, 0.652, 0.654, 0.654, 0.624,
                                0.654, 0.634,
                                0.654, 0.664, 0.674, 0.684, 0.614, 0.9)));
    }
    
    @Test
    public void testWithAllNullValues() throws IOException {
        testAllCharts(
                IITechChartUtils.createChartObject("a", Color.GREEN,
                        Arrays.asList(
                        		null, null,null,null,null,null,null,null,null,null,null,null,null,null,null,
                                null,null,
                                null,null,null,null)),
                IITechChartUtils.createChartObject("b", Color.BLUE,
                        Arrays.asList(
                                0.5, 0.354, 0.358, 0.364, 0.384, 0.394, 0.344, 0.324, 0.314, 0.352, 0.354, 0.354, 0.324,
                                0.354, 0.334,
                                0.354, 0.364, 0.374, 0.384, 0.314, 0.1)),
                IITechChartUtils.createChartObject("c", Color.BLUE,
                        Arrays.asList(
                                0.5, 0.654, 0.658, 0.664, 0.684, 0.694, 0.644, 0.624, 0.614, 0.652, 0.654, 0.654, 0.624,
                                0.654, 0.634,
                                0.654, 0.664, 0.674, 0.684, 0.614, 0.9)));
    }
    
    @Test
    public void testNumbersAbove1() throws IOException {
        testAllCharts(
                IITechChartUtils.createChartObject("x", new Color(211, 211, 211, 120), Collections.nCopies(20, 30.0d)),
                IITechChartUtils.createChartObject("y", Color.LIGHT_GRAY, Collections.nCopies(20, 70.0d)),
                IITechChartUtils.createChartObject("z", Color.BLUE,
                        Arrays.asList(
                                70.0,
                                42.0,
                                44.0,
                                33.0,
                                55.0,
                                54.3,
                                55.0,
                                10.0,
                                12.0,
                                44.0,
                                33.0,
                                55.0,
                                54.3,
                                55.0,
                                10.0,
                                12.0,
                                null,
                                33.0,
                                55.0,
                                5.0)));
    }
}
